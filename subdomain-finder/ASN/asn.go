package asn

import (
	"encoding/json"
	"io/ioutil"
	"log"
	"net/http"
	"strconv"
)

type ASNumber struct {
	As_Number int `json:"as_number"`
}

//func RetrieveASN(ip string) string, err {

//	var asn ASN

//}

func GetASN(IP string) string {

	var test ASNumber
	//IP := "8.8.8.8"
	resp, err := http.Get("http://api.iptoasn.com/v1/as/ip/" + IP) // + "?api-key=test")
	if err != nil {
		log.Fatalln(err)
	}

	defer resp.Body.Close()

	body, err := ioutil.ReadAll(resp.Body)
	//fmt.Println(body)
	if err != nil {
		log.Fatalln(err)
	}
	json.Unmarshal([]byte(body), &test)
	//fmt.Printf("%s\n", strconv.Itoa(test.As_Number))

	return strconv.Itoa(test.As_Number)

}
