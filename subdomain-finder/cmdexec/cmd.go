package cmdexec

import (
	"fmt"
	"log"
	"os/exec"
)

/* test
test
test
*/

func ExecInput(str string) {

	// Execute go-shodan (must be in the path)
	input := "go-shodan"
	arg1 := "search"
	arg2 := "-t"

	cmd, err := exec.Command(input, arg1, arg2, str).Output()
	if err != nil {
		log.Fatal(err)
		//continue
	}
	output := string(cmd[:])
	fmt.Println(output)

}

func ExecAmassASN(str string) {

	input := "amass"
	arg1 := "intel"
	arg2 := "-asn"
	arg3 := "-ip"

	cmd, err := exec.Command(input, arg1, arg2, str, arg3).Output()
	if err != nil {
		log.Fatal(err)
		//continue
	}
	output := string(cmd[:])
	fmt.Printf("[+] Launching amass scanner using AS%s\n", str)
	fmt.Println(output)

}

func ExecAmassScrap(str string) {

	input := "amass"
	arg1 := "enum"
	arg2 := "-d"
	//arg3 := "-ip"
	fmt.Printf("\n[+] Launching Amass Subdomain Scrapping for %s\n", str)

	cmd, err := exec.Command(input, arg1, arg2, str).Output()
	if err != nil {
		log.Fatal(err)
		//continue
	}
	output := string(cmd[:])
	fmt.Println(output)

}
